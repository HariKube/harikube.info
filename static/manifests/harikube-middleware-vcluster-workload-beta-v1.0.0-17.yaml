apiVersion: v1
kind: Namespace
metadata:
  name: harikube
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: harikube-db-pvc
  namespace: harikube
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 5Gi
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: harikube-middleware
  namespace: harikube
  labels:
    app: harikube
spec:
  replicas: 1
  selector:
    matchLabels:
      app: harikube
  template:
    metadata:
      labels:
        app: harikube
    spec:
      terminationGracePeriodSeconds: 31536000
      imagePullSecrets:
      - name: harikube-registry-secret
      containers:
      - name: middleware
        image: registry.harikube.info/harikube/middleware:beta-v1.0.0-17
        imagePullPolicy: IfNotPresent
        env:
        - name: TOPOLOGY_CONFIG
          value: secret://harikube/topology-config
        args:
        - --listen-address=0.0.0.0:2379
        - --datastore-max-idle-connections=5
        - --datastore-max-open-connections=90
        - --datastore-connection-max-lifetime=5m
        - --datastore-connection-max-idle-lifetime=5m
        - --endpoint=multi://sqlite:///db/main.db?_journal=WAL&cache=shared
        ports:
        - containerPort: 2379
          name: api-port
        - containerPort: 8080
          name: metrics
        volumeMounts:
        - name: db-storage
          mountPath: /db
        # livenessProbe:
        #   httpGet:
        #     path: /health
        #     port: api-port
        #   initialDelaySeconds: 15
        #   timeoutSeconds: 5
        #   periodSeconds: 20
        #   failureThreshold: 3
        # readinessProbe:
        #   httpGet:
        #     path: /ready
        #     port: api-port
        #   initialDelaySeconds: 5
        #   timeoutSeconds: 3
        #   periodSeconds: 10
        #   failureThreshold: 3
        securityContext:
          allowPrivilegeEscalation: false
          runAsGroup: 0
          runAsUser: 0
        resources:
          limits:
            memory: 4Gi
          requests:
            cpu: 1000m
            memory: 1Gi
      volumes:
      - name: db-storage
        persistentVolumeClaim:
          claimName: harikube-db-pvc
---
apiVersion: v1
kind: Service
metadata:
  name: harikube-middleware-svc
  namespace: harikube
spec:
  type: ClusterIP 
  selector:
    app: harikube
  ports:
    - name: api
      protocol: TCP
      port: 2379
      targetPort: api-port
---
apiVersion: v1
kind: Service
metadata:
  name: harikube-middleware-metrics
  namespace: harikube
  labels:
    app: harikube
    app.kubernetes.io/component: metrics 
spec:
  type: ClusterIP 
  selector:
    app: harikube
  ports:
    - name: metrics
      protocol: TCP
      port: 8080
      targetPort: metrics
---
---
# Source: vcluster/templates/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: vc-harikube
  namespace: harikube
  labels:
    app: vcluster
    chart: "vcluster-0.30.0"
    release: "harikube"
    heritage: "Helm"
---
# Source: vcluster/templates/workload-serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: vc-workload-harikube
  namespace: harikube
  labels:
    app: vcluster
    chart: "vcluster-0.30.0"
    release: "harikube"
    heritage: "Helm"
---
# Source: vcluster/templates/config-secret.yaml
apiVersion: v1
kind: Secret
metadata:
  name: "vc-config-harikube"
  namespace: harikube
  labels:
    app: vcluster
    chart: "vcluster-0.30.0"
    release: "harikube"
    heritage: "Helm"
type: Opaque
data:
  config.yaml: "Y29udHJvbFBsYW5lOgogIGFkdmFuY2VkOgogICAgY2xvdWRDb250cm9sbGVyTWFuYWdlcjoKICAgICAgZW5hYmxlZDogdHJ1ZQogICAgZGVmYXVsdEltYWdlUmVnaXN0cnk6ICIiCiAgICBnbG9iYWxNZXRhZGF0YToKICAgICAgYW5ub3RhdGlvbnM6IHt9CiAgICBoZWFkbGVzc1NlcnZpY2U6CiAgICAgIGFubm90YXRpb25zOiB7fQogICAgICBsYWJlbHM6IHt9CiAgICBrb25uZWN0aXZpdHk6CiAgICAgIGFnZW50OgogICAgICAgIGVuYWJsZWQ6IHRydWUKICAgICAgICBleHRyYUFyZ3M6IFtdCiAgICAgICAgZXh0cmFFbnY6IFtdCiAgICAgICAgaW1hZ2U6ICIiCiAgICAgICAgaW1hZ2VQdWxsUG9saWN5OiAiIgogICAgICAgIG5vZGVTZWxlY3Rvcjoge30KICAgICAgICByZXBsaWNhczogMQogICAgICAgIHRvbGVyYXRpb25zOiBbXQogICAgICBzZXJ2ZXI6CiAgICAgICAgZW5hYmxlZDogdHJ1ZQogICAgICAgIGV4dHJhQXJnczogW10KICAgIGt1YmVWaXA6CiAgICAgIGVuYWJsZWQ6IGZhbHNlCiAgICByZWdpc3RyeToKICAgICAgYW5vbnltb3VzUHVsbDogdHJ1ZQogICAgICBjb25maWc6IHt9CiAgICAgIGVuYWJsZWQ6IGZhbHNlCiAgICBzZXJ2aWNlQWNjb3VudDoKICAgICAgYW5ub3RhdGlvbnM6IHt9CiAgICAgIGVuYWJsZWQ6IHRydWUKICAgICAgaW1hZ2VQdWxsU2VjcmV0czogW10KICAgICAgbGFiZWxzOiB7fQogICAgICBuYW1lOiAiIgogICAgdmlydHVhbFNjaGVkdWxlcjoKICAgICAgZW5hYmxlZDogZmFsc2UKICAgIHdvcmtsb2FkU2VydmljZUFjY291bnQ6CiAgICAgIGFubm90YXRpb25zOiB7fQogICAgICBlbmFibGVkOiB0cnVlCiAgICAgIGltYWdlUHVsbFNlY3JldHM6IFtdCiAgICAgIGxhYmVsczoge30KICAgICAgbmFtZTogIiIKICBiYWNraW5nU3RvcmU6CiAgICBkYXRhYmFzZToKICAgICAgZW1iZWRkZWQ6CiAgICAgICAgZW5hYmxlZDogZmFsc2UKICAgICAgICBleHRyYUFyZ3M6IFtdCiAgICAgIGV4dGVybmFsOgogICAgICAgIGNhRmlsZTogIiIKICAgICAgICBjZXJ0RmlsZTogIiIKICAgICAgICBjb25uZWN0b3I6ICIiCiAgICAgICAgZGF0YVNvdXJjZTogIiIKICAgICAgICBlbmFibGVkOiBmYWxzZQogICAgICAgIGV4dHJhQXJnczogW10KICAgICAgICBpZGVudGl0eVByb3ZpZGVyOiAiIgogICAgICAgIGtleUZpbGU6ICIiCiAgICBldGNkOgogICAgICBkZXBsb3k6CiAgICAgICAgZW5hYmxlZDogZmFsc2UKICAgICAgICBoZWFkbGVzc1NlcnZpY2U6CiAgICAgICAgICBhbm5vdGF0aW9uczoge30KICAgICAgICBzZXJ2aWNlOgogICAgICAgICAgYW5ub3RhdGlvbnM6IHt9CiAgICAgICAgICBlbmFibGVkOiB0cnVlCiAgICAgICAgc3RhdGVmdWxTZXQ6CiAgICAgICAgICBhbm5vdGF0aW9uczoge30KICAgICAgICAgIGVuYWJsZVNlcnZpY2VMaW5rczogdHJ1ZQogICAgICAgICAgZW5hYmxlZDogdHJ1ZQogICAgICAgICAgZW52OiBbXQogICAgICAgICAgZXh0cmFBcmdzOiBbXQogICAgICAgICAgaGlnaEF2YWlsYWJpbGl0eToKICAgICAgICAgICAgcmVwbGljYXM6IDEKICAgICAgICAgIGltYWdlOgogICAgICAgICAgICByZWdpc3RyeTogcmVnaXN0cnkuazhzLmlvCiAgICAgICAgICAgIHJlcG9zaXRvcnk6IGV0Y2QKICAgICAgICAgICAgdGFnOiAzLjYuNC0wCiAgICAgICAgICBpbWFnZVB1bGxQb2xpY3k6ICIiCiAgICAgICAgICBsYWJlbHM6IHt9CiAgICAgICAgICBwZXJzaXN0ZW5jZToKICAgICAgICAgICAgYWRkVm9sdW1lTW91bnRzOiBbXQogICAgICAgICAgICBhZGRWb2x1bWVzOiBbXQogICAgICAgICAgICB2b2x1bWVDbGFpbToKICAgICAgICAgICAgICBhY2Nlc3NNb2RlczoKICAgICAgICAgICAgICAtIFJlYWRXcml0ZU9uY2UKICAgICAgICAgICAgICBlbmFibGVkOiB0cnVlCiAgICAgICAgICAgICAgcmV0ZW50aW9uUG9saWN5OiBSZXRhaW4KICAgICAgICAgICAgICBzaXplOiA1R2kKICAgICAgICAgICAgICBzdG9yYWdlQ2xhc3M6ICIiCiAgICAgICAgICAgIHZvbHVtZUNsYWltVGVtcGxhdGVzOiBbXQogICAgICAgICAgcG9kczoKICAgICAgICAgICAgYW5ub3RhdGlvbnM6IHt9CiAgICAgICAgICAgIGxhYmVsczoge30KICAgICAgICAgIHJlc291cmNlczoKICAgICAgICAgICAgcmVxdWVzdHM6CiAgICAgICAgICAgICAgY3B1OiAyMG0KICAgICAgICAgICAgICBtZW1vcnk6IDE1ME1pCiAgICAgICAgICBzY2hlZHVsaW5nOgogICAgICAgICAgICBhZmZpbml0eToge30KICAgICAgICAgICAgbm9kZVNlbGVjdG9yOiB7fQogICAgICAgICAgICBwb2RNYW5hZ2VtZW50UG9saWN5OiBQYXJhbGxlbAogICAgICAgICAgICBwcmlvcml0eUNsYXNzTmFtZTogIiIKICAgICAgICAgICAgdG9sZXJhdGlvbnM6IFtdCiAgICAgICAgICAgIHRvcG9sb2d5U3ByZWFkQ29uc3RyYWludHM6IFtdCiAgICAgICAgICBzZWN1cml0eToKICAgICAgICAgICAgY29udGFpbmVyU2VjdXJpdHlDb250ZXh0OiB7fQogICAgICAgICAgICBwb2RTZWN1cml0eUNvbnRleHQ6IHt9CiAgICAgIGVtYmVkZGVkOgogICAgICAgIGVuYWJsZWQ6IGZhbHNlCiAgICAgICAgZXh0cmFBcmdzOiBbXQogICAgICAgIG1pZ3JhdGVGcm9tRGVwbG95ZWRFdGNkOiBmYWxzZQogICAgICBleHRlcm5hbDoKICAgICAgICBlbmFibGVkOiBmYWxzZQogICAgICAgIGVuZHBvaW50OiAiIgogICAgICAgIHRsczoKICAgICAgICAgIGNhRmlsZTogIiIKICAgICAgICAgIGNlcnRGaWxlOiAiIgogICAgICAgICAga2V5RmlsZTogIiIKICBjb3JlZG5zOgogICAgZGVwbG95bWVudDoKICAgICAgYWZmaW5pdHk6IHt9CiAgICAgIGFubm90YXRpb25zOiB7fQogICAgICBpbWFnZTogIiIKICAgICAgbGFiZWxzOiB7fQogICAgICBub2RlU2VsZWN0b3I6IHt9CiAgICAgIHBvZHM6CiAgICAgICAgYW5ub3RhdGlvbnM6IHt9CiAgICAgICAgbGFiZWxzOiB7fQogICAgICByZXBsaWNhczogMQogICAgICByZXNvdXJjZXM6CiAgICAgICAgbGltaXRzOgogICAgICAgICAgY3B1OiAxMDAwbQogICAgICAgICAgbWVtb3J5OiAxNzBNaQogICAgICAgIHJlcXVlc3RzOgogICAgICAgICAgY3B1OiAyMG0KICAgICAgICAgIG1lbW9yeTogNjRNaQogICAgICB0b2xlcmF0aW9uczogW10KICAgICAgdG9wb2xvZ3lTcHJlYWRDb25zdHJhaW50czoKICAgICAgLSBsYWJlbFNlbGVjdG9yOgogICAgICAgICAgbWF0Y2hMYWJlbHM6CiAgICAgICAgICAgIGs4cy1hcHA6IHZjbHVzdGVyLWt1YmUtZG5zCiAgICAgICAgbWF4U2tldzogMQogICAgICAgIHRvcG9sb2d5S2V5OiBrdWJlcm5ldGVzLmlvL2hvc3RuYW1lCiAgICAgICAgd2hlblVuc2F0aXNmaWFibGU6IERvTm90U2NoZWR1bGUKICAgIGVtYmVkZGVkOiBmYWxzZQogICAgZW5hYmxlZDogdHJ1ZQogICAgb3ZlcndyaXRlQ29uZmlnOiAiIgogICAgb3ZlcndyaXRlTWFuaWZlc3RzOiAiIgogICAgcHJpb3JpdHlDbGFzc05hbWU6ICIiCiAgICBzZWN1cml0eToKICAgICAgY29udGFpbmVyU2VjdXJpdHlDb250ZXh0OiB7fQogICAgICBwb2RTZWN1cml0eUNvbnRleHQ6IHt9CiAgICBzZXJ2aWNlOgogICAgICBhbm5vdGF0aW9uczoge30KICAgICAgbGFiZWxzOiB7fQogICAgICBzcGVjOgogICAgICAgIHR5cGU6IENsdXN0ZXJJUAogIGRpc3RybzoKICAgIGszczoKICAgICAgY29tbWFuZDogW10KICAgICAgZW5hYmxlZDogZmFsc2UKICAgICAgZXh0cmFBcmdzOiBbXQogICAgICBpbWFnZToKICAgICAgICByZWdpc3RyeTogIiIKICAgICAgICByZXBvc2l0b3J5OiByYW5jaGVyL2szcwogICAgICAgIHRhZzogdjEuMzQuMS1rM3MxCiAgICAgIGltYWdlUHVsbFBvbGljeTogIiIKICAgICAgcmVzb3VyY2VzOgogICAgICAgIGxpbWl0czoKICAgICAgICAgIGNwdTogMTAwbQogICAgICAgICAgbWVtb3J5OiAyNTZNaQogICAgICAgIHJlcXVlc3RzOgogICAgICAgICAgY3B1OiA0MG0KICAgICAgICAgIG1lbW9yeTogNjRNaQogICAgICBzZWN1cml0eUNvbnRleHQ6IHt9CiAgICBrOHM6CiAgICAgIGFwaVNlcnZlcjoKICAgICAgICBjb21tYW5kOiBbXQogICAgICAgIGVuYWJsZWQ6IHRydWUKICAgICAgICBleHRyYUFyZ3M6CiAgICAgICAgLSAtLWZlYXR1cmUtZ2F0ZXM9V2F0Y2hMaXN0PXRydWUsV2F0Y2hMaXN0Q2xpZW50PXRydWUsVm9sdW1lQXR0cmlidXRlc0NsYXNzPXRydWUsTXV0YXRpbmdBZG1pc3Npb25Qb2xpY3k9dHJ1ZQogICAgICAgIC0gLS13YXRjaC1jYWNoZT1mYWxzZQogICAgICAgIC0gLS1ldGNkLXNlcnZlcnM9aHR0cDovL2hhcmlrdWJlLW1pZGRsZXdhcmUtc3ZjLmhhcmlrdWJlOjIzNzkKICAgICAgICAtIC0tcnVudGltZS1jb25maWc9YWRtaXNzaW9ucmVnaXN0cmF0aW9uLms4cy5pby92MWJldGExPXRydWUKICAgICAgICAtIC0tbWF4LXJlcXVlc3RzLWluZmxpZ2h0PTkwMAogICAgICAgIC0gLS1tYXgtbXV0YXRpbmctcmVxdWVzdHMtaW5mbGlnaHQ9MzAwCiAgICAgIGNvbnRyb2xsZXJNYW5hZ2VyOgogICAgICAgIGNvbW1hbmQ6IFtdCiAgICAgICAgZW5hYmxlZDogdHJ1ZQogICAgICAgIGV4dHJhQXJnczogW10KICAgICAgZW5hYmxlZDogdHJ1ZQogICAgICBlbnY6IFtdCiAgICAgIGltYWdlOgogICAgICAgIHJlZ2lzdHJ5OiBxdWF5LmlvCiAgICAgICAgcmVwb3NpdG9yeTogaGFyaWt1YmUva3ViZXJuZXRlcwogICAgICAgIHRhZzogdjEuMzQuMQogICAgICBpbWFnZVB1bGxQb2xpY3k6IElmTm90UHJlc2VudAogICAgICByZXNvdXJjZXM6CiAgICAgICAgbGltaXRzOgogICAgICAgICAgY3B1OiAxMDBtCiAgICAgICAgICBtZW1vcnk6IDI1Nk1pCiAgICAgICAgcmVxdWVzdHM6CiAgICAgICAgICBjcHU6IDQwbQogICAgICAgICAgbWVtb3J5OiA2NE1pCiAgICAgIHNjaGVkdWxlcjoKICAgICAgICBjb21tYW5kOiBbXQogICAgICAgIGVuYWJsZWQ6IHRydWUKICAgICAgICBleHRyYUFyZ3M6IFtdCiAgICAgIHNlY3VyaXR5Q29udGV4dDoge30KICAgICAgdmVyc2lvbjogIiIKICBpbmdyZXNzOgogICAgYW5ub3RhdGlvbnM6CiAgICAgIG5naW54LmluZ3Jlc3Mua3ViZXJuZXRlcy5pby9iYWNrZW5kLXByb3RvY29sOiBIVFRQUwogICAgICBuZ2lueC5pbmdyZXNzLmt1YmVybmV0ZXMuaW8vc3NsLXBhc3N0aHJvdWdoOiAidHJ1ZSIKICAgICAgbmdpbnguaW5ncmVzcy5rdWJlcm5ldGVzLmlvL3NzbC1yZWRpcmVjdDogInRydWUiCiAgICBlbmFibGVkOiBmYWxzZQogICAgaG9zdDogbXktaG9zdC5jb20KICAgIGxhYmVsczoge30KICAgIHBhdGhUeXBlOiBJbXBsZW1lbnRhdGlvblNwZWNpZmljCiAgICBzcGVjOgogICAgICB0bHM6IFtdCiAgcHJveHk6CiAgICBiaW5kQWRkcmVzczogMC4wLjAuMAogICAgZXh0cmFTQU5zOiBbXQogICAgcG9ydDogODQ0MwogIHNlcnZpY2U6CiAgICBhbm5vdGF0aW9uczoge30KICAgIGVuYWJsZWQ6IHRydWUKICAgIGh0dHBzTm9kZVBvcnQ6IDAKICAgIGt1YmVsZXROb2RlUG9ydDogMAogICAgbGFiZWxzOiB7fQogICAgc3BlYzoKICAgICAgdHlwZTogQ2x1c3RlcklQCiAgc2VydmljZU1vbml0b3I6CiAgICBhbm5vdGF0aW9uczoge30KICAgIGVuYWJsZWQ6IGZhbHNlCiAgICBsYWJlbHM6IHt9CiAgc3RhbmRhbG9uZToKICAgIGRhdGFEaXI6IC92YXIvbGliL3ZjbHVzdGVyCiAgICBqb2luTm9kZToKICAgICAgY29udGFpbmVyZDoKICAgICAgICBlbmFibGVkOiB0cnVlCiAgICAgIGVuYWJsZWQ6IHRydWUKICBzdGF0ZWZ1bFNldDoKICAgIGFubm90YXRpb25zOiB7fQogICAgYXJnczogW10KICAgIGNvbW1hbmQ6IFtdCiAgICBlbmFibGVTZXJ2aWNlTGlua3M6IHRydWUKICAgIGVudjogW10KICAgIGhpZ2hBdmFpbGFiaWxpdHk6CiAgICAgIGxlYXNlRHVyYXRpb246IDYwCiAgICAgIHJlbmV3RGVhZGxpbmU6IDQwCiAgICAgIHJlcGxpY2FzOiAxCiAgICAgIHJldHJ5UGVyaW9kOiAxNQogICAgaW1hZ2U6CiAgICAgIHJlZ2lzdHJ5OiBnaGNyLmlvCiAgICAgIHJlcG9zaXRvcnk6IGxvZnQtc2gvdmNsdXN0ZXItcHJvCiAgICAgIHRhZzogIiIKICAgIGltYWdlUHVsbFBvbGljeTogIiIKICAgIGluaXRDb250YWluZXJzOiBbXQogICAgbGFiZWxzOiB7fQogICAgcGVyc2lzdGVuY2U6CiAgICAgIGFkZFZvbHVtZU1vdW50czogW10KICAgICAgYWRkVm9sdW1lczogW10KICAgICAgYmluYXJpZXNWb2x1bWU6CiAgICAgIC0gZW1wdHlEaXI6IHt9CiAgICAgICAgbmFtZTogYmluYXJpZXMKICAgICAgZGF0YVZvbHVtZTogW10KICAgICAgdm9sdW1lQ2xhaW06CiAgICAgICAgYWNjZXNzTW9kZXM6CiAgICAgICAgLSBSZWFkV3JpdGVPbmNlCiAgICAgICAgZW5hYmxlZDogYXV0bwogICAgICAgIHJldGVudGlvblBvbGljeTogUmV0YWluCiAgICAgICAgc2l6ZTogNUdpCiAgICAgICAgc3RvcmFnZUNsYXNzOiAiIgogICAgICB2b2x1bWVDbGFpbVRlbXBsYXRlczogW10KICAgIHBvZHM6CiAgICAgIGFubm90YXRpb25zOiB7fQogICAgICBsYWJlbHM6IHt9CiAgICBwcm9iZXM6CiAgICAgIGxpdmVuZXNzUHJvYmU6CiAgICAgICAgZW5hYmxlZDogdHJ1ZQogICAgICAgIGZhaWx1cmVUaHJlc2hvbGQ6IDYwCiAgICAgICAgaW5pdGlhbERlbGF5U2Vjb25kczogNjAKICAgICAgICBwZXJpb2RTZWNvbmRzOiAyCiAgICAgICAgdGltZW91dFNlY29uZHM6IDMKICAgICAgcmVhZGluZXNzUHJvYmU6CiAgICAgICAgZW5hYmxlZDogdHJ1ZQogICAgICAgIGZhaWx1cmVUaHJlc2hvbGQ6IDYwCiAgICAgICAgcGVyaW9kU2Vjb25kczogMgogICAgICAgIHRpbWVvdXRTZWNvbmRzOiAzCiAgICAgIHN0YXJ0dXBQcm9iZToKICAgICAgICBlbmFibGVkOiB0cnVlCiAgICAgICAgZmFpbHVyZVRocmVzaG9sZDogMzAwCiAgICAgICAgcGVyaW9kU2Vjb25kczogNgogICAgICAgIHRpbWVvdXRTZWNvbmRzOiAzCiAgICByZXNvdXJjZXM6CiAgICAgIGxpbWl0czoKICAgICAgICBlcGhlbWVyYWwtc3RvcmFnZTogMTBHaQogICAgICAgIG1lbW9yeTogNEdpCiAgICAgIHJlcXVlc3RzOgogICAgICAgIGNwdTogMjAwbQogICAgICAgIGVwaGVtZXJhbC1zdG9yYWdlOiAxR2kKICAgICAgICBtZW1vcnk6IDI1Nk1pCiAgICBzY2hlZHVsaW5nOgogICAgICBhZmZpbml0eToge30KICAgICAgbm9kZVNlbGVjdG9yOiB7fQogICAgICBwb2RNYW5hZ2VtZW50UG9saWN5OiBQYXJhbGxlbAogICAgICBwcmlvcml0eUNsYXNzTmFtZTogIiIKICAgICAgdG9sZXJhdGlvbnM6IFtdCiAgICAgIHRvcG9sb2d5U3ByZWFkQ29uc3RyYWludHM6IFtdCiAgICBzZWN1cml0eToKICAgICAgY29udGFpbmVyU2VjdXJpdHlDb250ZXh0OgogICAgICAgIGFsbG93UHJpdmlsZWdlRXNjYWxhdGlvbjogZmFsc2UKICAgICAgICBydW5Bc0dyb3VwOiAwCiAgICAgICAgcnVuQXNVc2VyOiAwCiAgICAgIHBvZFNlY3VyaXR5Q29udGV4dDoge30KICAgIHNpZGVjYXJDb250YWluZXJzOiBbXQogICAgd29ya2luZ0RpcjogIiIKZGVwbG95OgogIGNuaToKICAgIGZsYW5uZWw6CiAgICAgIGVuYWJsZWQ6IHRydWUKICBpbmdyZXNzTmdpbng6CiAgICBkZWZhdWx0SW5ncmVzc0NsYXNzOiB0cnVlCiAgICBlbmFibGVkOiBmYWxzZQogIGt1YmVQcm94eToKICAgIGNvbmZpZzoge30KICAgIGVuYWJsZWQ6IHRydWUKICAgIGV4dHJhQXJnczogW10KICAgIGV4dHJhRW52OiBbXQogICAgaW1hZ2U6ICIiCiAgICBpbWFnZVB1bGxQb2xpY3k6ICIiCiAgICBub2RlU2VsZWN0b3I6IHt9CiAgICB0b2xlcmF0aW9uczogW10KICBsb2NhbFBhdGhQcm92aXNpb25lcjoKICAgIGVuYWJsZWQ6IHRydWUKICBtZXRhbGxiOgogICAgZW5hYmxlZDogZmFsc2UKICAgIGlwQWRkcmVzc1Bvb2w6CiAgICAgIGFkZHJlc3NlczogW10KICAgICAgbDJBZHZlcnRpc2VtZW50OiB0cnVlCiAgbWV0cmljc1NlcnZlcjoKICAgIGVuYWJsZWQ6IGZhbHNlCiAgdm9sdW1lU25hcHNob3RDb250cm9sbGVyOgogICAgZW5hYmxlZDogZmFsc2UKZXhwZXJpbWVudGFsOgogIGRlcGxveToKICAgIGhvc3Q6CiAgICAgIG1hbmlmZXN0czogIiIKICAgICAgbWFuaWZlc3RzVGVtcGxhdGU6ICIiCiAgICB2Y2x1c3RlcjoKICAgICAgaGVsbTogW10KICAgICAgbWFuaWZlc3RzOiAiIgogICAgICBtYW5pZmVzdHNUZW1wbGF0ZTogIiIKICBzeW5jU2V0dGluZ3M6CiAgICBzZXRPd25lcjogdHJ1ZQpleHBvcnRLdWJlQ29uZmlnOgogIGNvbnRleHQ6ICIiCiAgaW5zZWN1cmU6IGZhbHNlCiAgc2VjcmV0OgogICAgbmFtZTogIiIKICAgIG5hbWVzcGFjZTogIiIKICBzZXJ2ZXI6ICIiCiAgc2VydmljZUFjY291bnQ6CiAgICBjbHVzdGVyUm9sZTogIiIKICAgIG5hbWU6ICIiCiAgICBuYW1lc3BhY2U6ICIiCmV4dGVybmFsOiB7fQppbnRlZ3JhdGlvbnM6CiAgY2VydE1hbmFnZXI6CiAgICBlbmFibGVkOiBmYWxzZQogICAgc3luYzoKICAgICAgZnJvbUhvc3Q6CiAgICAgICAgY2x1c3Rlcklzc3VlcnM6CiAgICAgICAgICBlbmFibGVkOiB0cnVlCiAgICAgICAgICBzZWxlY3RvcjoKICAgICAgICAgICAgbGFiZWxzOiB7fQogICAgICB0b0hvc3Q6CiAgICAgICAgY2VydGlmaWNhdGVzOgogICAgICAgICAgZW5hYmxlZDogdHJ1ZQogICAgICAgIGlzc3VlcnM6CiAgICAgICAgICBlbmFibGVkOiB0cnVlCiAgZXh0ZXJuYWxTZWNyZXRzOgogICAgZW5hYmxlZDogZmFsc2UKICAgIHN5bmM6CiAgICAgIGZyb21Ib3N0OgogICAgICAgIGNsdXN0ZXJTdG9yZXM6CiAgICAgICAgICBlbmFibGVkOiBmYWxzZQogICAgICAgICAgc2VsZWN0b3I6CiAgICAgICAgICAgIG1hdGNoTGFiZWxzOiB7fQogICAgICB0b0hvc3Q6CiAgICAgICAgZXh0ZXJuYWxTZWNyZXRzOgogICAgICAgICAgc2VsZWN0b3I6CiAgICAgICAgICAgIG1hdGNoTGFiZWxzOiB7fQogICAgICAgIHN0b3JlczoKICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlCiAgICAgICAgICBzZWxlY3RvcjoKICAgICAgICAgICAgbWF0Y2hMYWJlbHM6IHt9CiAgICB3ZWJob29rOgogICAgICBlbmFibGVkOiBmYWxzZQogIGlzdGlvOgogICAgZW5hYmxlZDogZmFsc2UKICAgIHN5bmM6CiAgICAgIHRvSG9zdDoKICAgICAgICBkZXN0aW5hdGlvblJ1bGVzOgogICAgICAgICAgZW5hYmxlZDogdHJ1ZQogICAgICAgIGdhdGV3YXlzOgogICAgICAgICAgZW5hYmxlZDogdHJ1ZQogICAgICAgIHZpcnR1YWxTZXJ2aWNlczoKICAgICAgICAgIGVuYWJsZWQ6IHRydWUKICBrdWJlVmlydDoKICAgIGVuYWJsZWQ6IGZhbHNlCiAgICBzeW5jOgogICAgICBkYXRhVm9sdW1lczoKICAgICAgICBlbmFibGVkOiBmYWxzZQogICAgICB2aXJ0dWFsTWFjaGluZUNsb25lczoKICAgICAgICBlbmFibGVkOiB0cnVlCiAgICAgIHZpcnR1YWxNYWNoaW5lSW5zdGFuY2VNaWdyYXRpb25zOgogICAgICAgIGVuYWJsZWQ6IHRydWUKICAgICAgdmlydHVhbE1hY2hpbmVJbnN0YW5jZXM6CiAgICAgICAgZW5hYmxlZDogdHJ1ZQogICAgICB2aXJ0dWFsTWFjaGluZVBvb2xzOgogICAgICAgIGVuYWJsZWQ6IHRydWUKICAgICAgdmlydHVhbE1hY2hpbmVzOgogICAgICAgIGVuYWJsZWQ6IHRydWUKICAgIHdlYmhvb2s6CiAgICAgIGVuYWJsZWQ6IHRydWUKICBtZXRyaWNzU2VydmVyOgogICAgZW5hYmxlZDogZmFsc2UKICAgIG5vZGVzOiB0cnVlCiAgICBwb2RzOiB0cnVlCmxvZ2dpbmc6CiAgZW5jb2Rpbmc6IGNvbnNvbGUKbmV0d29ya2luZzoKICBhZHZhbmNlZDoKICAgIGNsdXN0ZXJEb21haW46IGNsdXN0ZXIubG9jYWwKICAgIGZhbGxiYWNrSG9zdENsdXN0ZXI6IGZhbHNlCiAgICBwcm94eUt1YmVsZXRzOgogICAgICBieUhvc3RuYW1lOiB0cnVlCiAgICAgIGJ5SVA6IHRydWUKICBwb2RDSURSOiAxMC4yNDQuMC4wLzE2CiAgcmVwbGljYXRlU2VydmljZXM6CiAgICBmcm9tSG9zdDogW10KICAgIHRvSG9zdDogW10KICByZXNvbHZlRE5TOiBbXQpwbHVnaW5zOiB7fQpwb2xpY2llczoKICBjZW50cmFsQWRtaXNzaW9uOgogICAgbXV0YXRpbmdXZWJob29rczogW10KICAgIHZhbGlkYXRpbmdXZWJob29rczogW10KICBsaW1pdFJhbmdlOgogICAgYW5ub3RhdGlvbnM6IHt9CiAgICBkZWZhdWx0OgogICAgICBjcHU6ICIxIgogICAgICBlcGhlbWVyYWwtc3RvcmFnZTogOEdpCiAgICAgIG1lbW9yeTogNTEyTWkKICAgIGRlZmF1bHRSZXF1ZXN0OgogICAgICBjcHU6IDEwMG0KICAgICAgZXBoZW1lcmFsLXN0b3JhZ2U6IDNHaQogICAgICBtZW1vcnk6IDEyOE1pCiAgICBlbmFibGVkOiBhdXRvCiAgICBsYWJlbHM6IHt9CiAgICBtYXg6IHt9CiAgICBtaW46IHt9CiAgbmV0d29ya1BvbGljeToKICAgIGFubm90YXRpb25zOiB7fQogICAgZW5hYmxlZDogZmFsc2UKICAgIGV4dHJhQ29udHJvbFBsYW5lUnVsZXM6IFtdCiAgICBleHRyYVdvcmtsb2FkUnVsZXM6IFtdCiAgICBmYWxsYmFja0RuczogOC44LjguOAogICAgbGFiZWxzOiB7fQogICAgb3V0Z29pbmdDb25uZWN0aW9uczoKICAgICAgaXBCbG9jazoKICAgICAgICBjaWRyOiAwLjAuMC4wLzAKICAgICAgICBleGNlcHQ6CiAgICAgICAgLSAxMDAuNjQuMC4wLzEwCiAgICAgICAgLSAxMjcuMC4wLjAvOAogICAgICAgIC0gMTAuMC4wLjAvOAogICAgICAgIC0gMTcyLjE2LjAuMC8xMgogICAgICAgIC0gMTkyLjE2OC4wLjAvMTYKICAgICAgcGxhdGZvcm06IHRydWUKICByZXNvdXJjZVF1b3RhOgogICAgYW5ub3RhdGlvbnM6IHt9CiAgICBlbmFibGVkOiBhdXRvCiAgICBsYWJlbHM6IHt9CiAgICBxdW90YToKICAgICAgY291bnQvY29uZmlnbWFwczogMTAwCiAgICAgIGNvdW50L2VuZHBvaW50czogNDAKICAgICAgY291bnQvcGVyc2lzdGVudHZvbHVtZWNsYWltczogMjAKICAgICAgY291bnQvcG9kczogMjAKICAgICAgY291bnQvc2VjcmV0czogMTAwCiAgICAgIGNvdW50L3NlcnZpY2VzOiAyMAogICAgICBsaW1pdHMuY3B1OiAyMAogICAgICBsaW1pdHMuZXBoZW1lcmFsLXN0b3JhZ2U6IDE2MEdpCiAgICAgIGxpbWl0cy5tZW1vcnk6IDQwR2kKICAgICAgcmVxdWVzdHMuY3B1OiAxMAogICAgICByZXF1ZXN0cy5lcGhlbWVyYWwtc3RvcmFnZTogNjBHaQogICAgICByZXF1ZXN0cy5tZW1vcnk6IDIwR2kKICAgICAgcmVxdWVzdHMuc3RvcmFnZTogMTAwR2kKICAgICAgc2VydmljZXMubG9hZGJhbGFuY2VyczogMQogICAgICBzZXJ2aWNlcy5ub2RlcG9ydHM6IDAKICAgIHNjb3BlU2VsZWN0b3I6CiAgICAgIG1hdGNoRXhwcmVzc2lvbnM6IFtdCiAgICBzY29wZXM6IFtdCnByaXZhdGVOb2RlczoKICBhdXRvTm9kZXM6IFtdCiAgYXV0b1VwZ3JhZGU6CiAgICBjb25jdXJyZW5jeTogMQogICAgZW5hYmxlZDogdHJ1ZQogIGVuYWJsZWQ6IGZhbHNlCiAgam9pbk5vZGU6CiAgICBjb250YWluZXJkOgogICAgICBlbmFibGVkOiB0cnVlCiAga3ViZWxldDoKICAgIGNvbmZpZzoge30KICB2cG46CiAgICBlbmFibGVkOiBmYWxzZQogICAgbm9kZVRvTm9kZToKICAgICAgZW5hYmxlZDogZmFsc2UKcmJhYzoKICBjbHVzdGVyUm9sZToKICAgIGVuYWJsZWQ6IGF1dG8KICAgIGV4dHJhUnVsZXM6IFtdCiAgICBvdmVyd3JpdGVSdWxlczogW10KICBlbmFibGVWb2x1bWVTbmFwc2hvdFJ1bGVzOgogICAgZW5hYmxlZDogYXV0bwogIHJvbGU6CiAgICBlbmFibGVkOiB0cnVlCiAgICBleHRyYVJ1bGVzOiBbXQogICAgb3ZlcndyaXRlUnVsZXM6IFtdCnN5bmM6CiAgZnJvbUhvc3Q6CiAgICBjb25maWdNYXBzOgogICAgICBlbmFibGVkOiBmYWxzZQogICAgICBtYXBwaW5nczoKICAgICAgICBieU5hbWU6IHt9CiAgICBjc2lEcml2ZXJzOgogICAgICBlbmFibGVkOiBhdXRvCiAgICBjc2lOb2RlczoKICAgICAgZW5hYmxlZDogYXV0bwogICAgY3NpU3RvcmFnZUNhcGFjaXRpZXM6CiAgICAgIGVuYWJsZWQ6IGF1dG8KICAgIGV2ZW50czoKICAgICAgZW5hYmxlZDogdHJ1ZQogICAgaW5ncmVzc0NsYXNzZXM6CiAgICAgIGVuYWJsZWQ6IGZhbHNlCiAgICBub2RlczoKICAgICAgY2xlYXJJbWFnZVN0YXR1czogZmFsc2UKICAgICAgZW5hYmxlZDogdHJ1ZQogICAgICBzZWxlY3RvcjoKICAgICAgICBhbGw6IGZhbHNlCiAgICAgICAgbGFiZWxzOiB7fQogICAgICBzeW5jQmFja0NoYW5nZXM6IGZhbHNlCiAgICBwcmlvcml0eUNsYXNzZXM6CiAgICAgIGVuYWJsZWQ6IGZhbHNlCiAgICBydW50aW1lQ2xhc3NlczoKICAgICAgZW5hYmxlZDogZmFsc2UKICAgIHNlY3JldHM6CiAgICAgIGVuYWJsZWQ6IHRydWUKICAgICAgbWFwcGluZ3M6CiAgICAgICAgYnlOYW1lOgogICAgICAgICAgIiI6IGhhcmlrdWJlCiAgICBzdG9yYWdlQ2xhc3NlczoKICAgICAgZW5hYmxlZDogYXV0bwogICAgdm9sdW1lU25hcHNob3RDbGFzc2VzOgogICAgICBlbmFibGVkOiBmYWxzZQogIHRvSG9zdDoKICAgIGNvbmZpZ01hcHM6CiAgICAgIGFsbDogZmFsc2UKICAgICAgZW5hYmxlZDogdHJ1ZQogICAgZW5kcG9pbnRTbGljZXM6CiAgICAgIGVuYWJsZWQ6IHRydWUKICAgIGVuZHBvaW50czoKICAgICAgZW5hYmxlZDogdHJ1ZQogICAgaW5ncmVzc2VzOgogICAgICBlbmFibGVkOiBmYWxzZQogICAgbmFtZXNwYWNlczoKICAgICAgZW5hYmxlZDogZmFsc2UKICAgICAgbWFwcGluZ3NPbmx5OiBmYWxzZQogICAgbmV0d29ya1BvbGljaWVzOgogICAgICBlbmFibGVkOiBmYWxzZQogICAgcGVyc2lzdGVudFZvbHVtZUNsYWltczoKICAgICAgZW5hYmxlZDogdHJ1ZQogICAgcGVyc2lzdGVudFZvbHVtZXM6CiAgICAgIGVuYWJsZWQ6IGZhbHNlCiAgICBwb2REaXNydXB0aW9uQnVkZ2V0czoKICAgICAgZW5hYmxlZDogZmFsc2UKICAgIHBvZHM6CiAgICAgIGVuYWJsZWQ6IHRydWUKICAgICAgZW5mb3JjZVRvbGVyYXRpb25zOiBbXQogICAgICBoeWJyaWRTY2hlZHVsaW5nOgogICAgICAgIGVuYWJsZWQ6IGZhbHNlCiAgICAgICAgaG9zdFNjaGVkdWxlcnM6IFtdCiAgICAgIHByaW9yaXR5Q2xhc3NOYW1lOiAiIgogICAgICByZXdyaXRlSG9zdHM6CiAgICAgICAgZW5hYmxlZDogdHJ1ZQogICAgICAgIGluaXRDb250YWluZXI6CiAgICAgICAgICBpbWFnZToKICAgICAgICAgICAgcmVnaXN0cnk6IG1pcnJvci5nY3IuaW8KICAgICAgICAgICAgcmVwb3NpdG9yeTogbGlicmFyeS9hbHBpbmUKICAgICAgICAgICAgdGFnOiAiMy4yMCIKICAgICAgICAgIHJlc291cmNlczoKICAgICAgICAgICAgbGltaXRzOgogICAgICAgICAgICAgIGNwdTogMzBtCiAgICAgICAgICAgICAgbWVtb3J5OiA2NE1pCiAgICAgICAgICAgIHJlcXVlc3RzOgogICAgICAgICAgICAgIGNwdTogMzBtCiAgICAgICAgICAgICAgbWVtb3J5OiA2NE1pCiAgICAgIHJ1bnRpbWVDbGFzc05hbWU6ICIiCiAgICAgIHRyYW5zbGF0ZUltYWdlOiB7fQogICAgICB1c2VTZWNyZXRzRm9yU0FUb2tlbnM6IGZhbHNlCiAgICBwcmlvcml0eUNsYXNzZXM6CiAgICAgIGVuYWJsZWQ6IGZhbHNlCiAgICBzZWNyZXRzOgogICAgICBhbGw6IGZhbHNlCiAgICAgIGVuYWJsZWQ6IHRydWUKICAgIHNlcnZpY2VBY2NvdW50czoKICAgICAgZW5hYmxlZDogZmFsc2UKICAgIHNlcnZpY2VzOgogICAgICBlbmFibGVkOiB0cnVlCiAgICBzdG9yYWdlQ2xhc3NlczoKICAgICAgZW5hYmxlZDogZmFsc2UKICAgIHZvbHVtZVNuYXBzaG90Q29udGVudHM6CiAgICAgIGVuYWJsZWQ6IGZhbHNlCiAgICB2b2x1bWVTbmFwc2hvdHM6CiAgICAgIGVuYWJsZWQ6IGZhbHNlCnRlbGVtZXRyeToKICBlbmFibGVkOiB0cnVl"
---
# Source: vcluster/templates/clusterrole.yaml
kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: vc-harikube-v-harikube
  labels:
    app: vcluster
    chart: "vcluster-0.30.0"
    release: "harikube"
    heritage: "Helm"
rules:
  - apiGroups: [""]
    resources: ["pods", "nodes", "nodes/status", "nodes/metrics", "nodes/stats", "nodes/proxy"]
    verbs: ["get", "watch", "list"]
  - apiGroups: ["storage.k8s.io"]
    resources: ["storageclasses", "csinodes", "csidrivers", "csistoragecapacities"]
    verbs: ["get", "watch", "list"]
  - apiGroups: [ "" ]
    resources: [ "persistentvolumes" ]
    verbs: [ "get", "list" ]
  - apiGroups: [ "snapshot.storage.k8s.io" ]
    resources: [ "volumesnapshotclasses" ]
    verbs: ["get", "list"]
  - apiGroups: [ "snapshot.storage.k8s.io" ]
    resources: [ "volumesnapshotcontents" ]
    verbs: ["create", "delete", "patch", "update", "get", "list"]
  
  - apiGroups: [""]
    resources: [ "namespaces" ]
    resourceNames: [ "harikube" ]
    verbs: ["get", "list", "watch"]
  - apiGroups: [""]
    resources: [ "secrets" ]
    verbs: ["list", "watch"]
  - apiGroups: [""]
    resources: [ "secrets" ]
    verbs: ["get"]
    resourceNames: [ "" ]
---
# Source: vcluster/templates/clusterrolebinding.yaml
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: vc-harikube-v-harikube
  labels:
    app: vcluster
    chart: "vcluster-0.30.0"
    release: "harikube"
    heritage: "Helm"
subjects:
  - kind: ServiceAccount
    name: vc-harikube
    namespace: harikube
roleRef:
  kind: ClusterRole
  name: vc-harikube-v-harikube
  apiGroup: rbac.authorization.k8s.io
---
# Source: vcluster/templates/role.yaml
kind: Role
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: vc-harikube
  namespace: harikube
  labels:
    app: vcluster
    chart: "vcluster-0.30.0"
    release: "harikube"
    heritage: "Helm"
rules:
  - apiGroups: [""]
    resources: ["configmaps", "secrets", "services", "pods", "pods/attach", "pods/portforward", "pods/exec", "persistentvolumeclaims"]
    verbs: ["create", "delete", "patch", "update", "get", "list", "watch"]
  - apiGroups: [""]
    resources: ["pods/status", "pods/ephemeralcontainers"]
    verbs: ["patch", "update"]
  - apiGroups: ["apps"]
    resources: ["statefulsets", "replicasets", "deployments"]
    verbs: ["get", "list", "watch"]
  - apiGroups: [""]
    resources: ["endpoints", "pods/log"]
    verbs: ["get", "list", "watch"]
  - apiGroups: [ "" ]
    resources: ["events"]
    verbs: [ "create", "get", "list", "watch" ]
  - apiGroups: [""]
    resources: ["endpoints"]
    verbs: ["create", "delete", "patch", "update"]
  - apiGroups: ["discovery.k8s.io"]
    resources: [ "endpointslices" ]
    verbs: [ "create", "list", "get", "delete", "patch", "update", "watch" ]
  - apiGroups: [ "snapshot.storage.k8s.io" ]
    resources: [ "volumesnapshots" ]
    verbs: ["create", "delete", "patch", "update", "get", "list"]
---
# Source: vcluster/templates/rolebinding.yaml
kind: RoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: vc-harikube
  namespace: harikube
  labels:
    app: vcluster
    chart: "vcluster-0.30.0"
    release: "harikube"
    heritage: "Helm"
subjects:
  - kind: ServiceAccount
    name: vc-harikube
    namespace: harikube
roleRef:
  kind: Role
  name: vc-harikube
  apiGroup: rbac.authorization.k8s.io
---
# Source: vcluster/templates/headless-service.yaml
apiVersion: v1
kind: Service
metadata:
  name: harikube-headless
  namespace: harikube
  labels:
    app: vcluster
    chart: "vcluster-0.30.0"
    release: "harikube"
    heritage: "Helm"
spec:
  publishNotReadyAddresses: true
  ports:
    - name: https
      port: 443
      targetPort: 8443
      protocol: TCP
  clusterIP: None
  selector:
    app: vcluster
    release: "harikube"
---
# Source: vcluster/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: harikube
  namespace: harikube
  labels:
    app: vcluster
    chart: "vcluster-0.30.0"
    release: "harikube"
    heritage: "Helm"
    vcluster.loft.sh/service: "true"
spec:
  type: ClusterIP
  ports:
    - name: https
      port: 443
      targetPort: 8443
      nodePort: 0
      protocol: TCP
    - name: kubelet
      port: 10250
      targetPort: 8443
      nodePort: 0
      protocol: TCP
  selector:
    app: vcluster
    release: harikube
---
# Source: vcluster/templates/statefulset.yaml
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: harikube
  namespace: harikube
  labels:
    app: vcluster
    chart: "vcluster-0.30.0"
    release: harikube
    heritage: "Helm"
spec:
  selector:
    matchLabels:
      app: vcluster
      release: "harikube"
  persistentVolumeClaimRetentionPolicy:
    whenDeleted: Retain
  serviceName: harikube-headless
  podManagementPolicy: Parallel
  
  volumeClaimTemplates:
  - metadata:
      name: data
    spec:
      accessModes: [ReadWriteOnce]
      resources:
        requests:
          storage: 5Gi
  replicas: 1
  template:
    metadata:
      annotations:
        vClusterConfigHash: "0c487f2173a1d0e0d325b7478cb11b2b0c6c101e9543d05b01ea735335405187"
      labels:
        app: vcluster
        release: harikube
    spec:
      terminationGracePeriodSeconds: 10
      serviceAccountName: vc-harikube
      volumes:        
        - name: helm-cache
          emptyDir: {}
        - emptyDir: {}
          name: binaries
        - name: tmp
          emptyDir: {}
        - name: certs
          emptyDir: {}
        - name: vcluster-config
          secret:
            secretName: vc-config-harikube
      initContainers:
        
        - name: kubernetes
          image: "quay.io/harikube/kubernetes:v1.34.1"
          volumeMounts:
            - mountPath: /binaries
              name: binaries
          command:
            - cp
          args:
            - -r 
            - /kubernetes/.
            - /binaries/
          imagePullPolicy: IfNotPresent
          securityContext:
            {}
          resources:
            limits:
              cpu: 100m
              memory: 256Mi
            requests:
              cpu: 40m
              memory: 64Mi
      enableServiceLinks: true
      containers:
        - name: syncer
          image: "ghcr.io/loft-sh/vcluster-pro:0.30.0"
          imagePullPolicy: 
          livenessProbe:
            httpGet:
              path: /healthz
              port: 8443
              scheme: HTTPS
            initialDelaySeconds: 60
            periodSeconds: 2
            timeoutSeconds: 3
            failureThreshold: 60
          readinessProbe:
            httpGet:
              path: /readyz
              port: 8443
              scheme: HTTPS
            periodSeconds: 2
            timeoutSeconds: 3
            failureThreshold: 60
          startupProbe:
            httpGet:
              path: /readyz
              port: 8443
              scheme: HTTPS
            periodSeconds: 6
            timeoutSeconds: 3
            failureThreshold: 300
          securityContext:
            allowPrivilegeEscalation: false
            runAsGroup: 0
            runAsUser: 0
          resources:
            limits:
              ephemeral-storage: 10Gi
              memory: 4Gi
            requests:
              cpu: 200m
              ephemeral-storage: 1Gi
              memory: 256Mi
          env:
            - name: VCLUSTER_NAME
              value: "harikube"
            - name: LOFT_LOG_ENCODING
              value: console
            - name: POD_NAME
              valueFrom:
                fieldRef:
                  fieldPath: metadata.name
            - name: POD_IP
              valueFrom:
                fieldRef:
                  fieldPath: status.podIP
            - name: NODE_NAME
              valueFrom:
                fieldRef:
                  fieldPath: spec.nodeName
            - name: NODE_IP
              valueFrom:
                fieldRef:
                  fieldPath: status.hostIP
            
          volumeMounts:            
            - name: data
              mountPath: /data
            - name: binaries
              mountPath: /binaries
            - name: certs
              mountPath: /pki
            - name: helm-cache
              mountPath: /.cache/helm
            - name: vcluster-config
              mountPath: /var/lib/vcluster
            - name: tmp
              mountPath: /tmp
